---
title: train
keywords: 
sidebar: home_sidebar
tags: 
summary: "Provides advanced training extensions to `fastai.basic_train`. Includes half-precision, learning rate finder, mixup, and one-cycle"
---

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Additional-training-functions">Additional training functions<a class="anchor-link" href="#Additional-training-functions">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/train.html#train"><code>train</code></a> provides a number of extension methods that are added to <a href="/basic_train.html#Learner"><code>Learner</code></a> (see below for a list and details), along with three simple callbacks:</p>
<ul>
<li><a href="/train.html#ShowGraph"><code>ShowGraph</code></a></li>
<li><a href="/train.html#GradientClipping"><code>GradientClipping</code></a></li>
<li><a href="/train.html#BnFreeze"><code>BnFreeze</code></a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Learner-extension-methods"><a href="/basic_train.html#Learner"><code>Learner</code></a> extension methods<a class="anchor-link" href="#Learner-extension-methods">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These methods are automatically added to all <a href="/basic_train.html#Learner"><code>Learner</code></a> objects created after importing this module. They provide convenient access to a number of callbacks, without requiring them to be manually created.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=fit_one_cycle></a><code>fit_one_cycle</code></h4>
<p><code>fit_one_cycle</code>(<code>learn</code>:<a href="/basic_train.html#Learner"><code>Learner</code></a>, <code>cyc_len</code>:<code>int</code>, <code>max_lr</code>:<code>Union</code>[<code>float</code>, <code>Collection</code>[<code>float</code>], <code>slice</code>]=<code>slice(None, 0.003, None)</code>, <code>moms</code>:<code>Tuple</code>[<code>float</code>, <code>float</code>]=<code>(0.95, 0.85)</code>, <code>div_factor</code>:<code>float</code>=<code>25.0</code>, <code>pct_start</code>:<code>float</code>=<code>0.3</code>, <code>wd</code>:<code>float</code>=<code>None</code>, <code>kwargs</code>)</p>
<p>Fits a model following the 1cycle policy <a href="https://github.com/fastai/fastai_pytorch/blob/master/fastai/train.py#L11">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Fit a model with 1cycle training. See <a href="/callbacks.one_cycle.html#OneCycleScheduler"><code>OneCycleScheduler</code></a> for details.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=lr_find></a><code>lr_find</code></h4>
<p><code>lr_find</code>(<code>learn</code>:<a href="/basic_train.html#Learner"><code>Learner</code></a>, <code>start_lr</code>:<code>float</code>=<code>1e-05</code>, <code>end_lr</code>:<code>float</code>=<code>10</code>, <code>num_it</code>:<code>int</code>=<code>100</code>, <code>kwargs</code>:<code>Any</code>)</p>
<p>Explore lr from <code>start_lr</code> to <code>end_lr</code> over <code>num_it</code> iterations of <code>learn</code> <a href="https://github.com/fastai/fastai_pytorch/blob/master/fastai/train.py#L20">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>See <a href="/callbacks.lr_finder.html#LRFinder"><code>LRFinder</code></a> for details.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=to_fp16></a><code>to_fp16</code></h4>
<p><code>to_fp16</code>(<code>learn</code>:<a href="/basic_train.html#Learner"><code>Learner</code></a>, <code>loss_scale</code>:<code>float</code>=<code>512.0</code>, <code>flat_master</code>:<code>bool</code>=<code>False</code>) -&gt; <a href="/basic_train.html#Learner"><code>Learner</code></a></p>
<p>Transforms the learner in FP16 precision <a href="https://github.com/fastai/fastai_pytorch/blob/master/fastai/train.py#L26">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>See <a href="/callbacks.fp16.html#MixedPrecision"><code>MixedPrecision</code></a> for details.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2><a id=ShowGraph></a>class <code>ShowGraph</code></h2>
<p><code>ShowGraph</code>(<code>learn</code>:<a href="/basic_train.html#Learner"><code>Learner</code></a>) :: <a href="/basic_train.html#LearnerCallback"><code>LearnerCallback</code></a></p>
<p>Updates a graph of learner stats and metrics after each epoch <a href="https://github.com/fastai/fastai_pytorch/blob/master/fastai/train.py#L44">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">get_mnist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">ConvLearner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">tvm</span><span class="o">.</span><span class="n">resnet18</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">callback_fns</span><span class="o">=</span><span class="n">ShowGraph</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




 
 
<div id="52eac7ca-7b8d-4200-b9a3-2bbe9eb89ade"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#52eac7ca-7b8d-4200-b9a3-2bbe9eb89ade');
</script>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Total time: 00:15
epoch  train loss  valid loss  accuracy
0      0.087847    0.041322    0.987242  (00:05)
1      0.041547    0.021118    0.993131  (00:05)
2      0.022978    0.013435    0.996565  (00:04)

</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXcAAAD8CAYAAACMwORRAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAIABJREFUeJzt3Xt0XOV97vHvby6a0f0uWZZky8bGF7AxYIwDJCEJUEMSyDmhxDS0lKZltUmaS9MLWWlTkub00Jy1EppTQkJakjYlcAhpGid1QgjBuIvEYAHG+IZv2JZ8kyxZd400l/f8MWNHyLqM7RlvafR81po1s/e8s/f7GvHsd9699zvmnENERHKLz+sKiIhI5incRURykMJdRCQHKdxFRHKQwl1EJAcp3EVEcpDCXUQkByncRURykMJdRCQHBbzacV5hmVu+ZIFXuxcRmZZefvnlE8656snKeRbu4Ypampubvdq9iMi0ZGYH0ymnYRkRkRzkWbhrvjIRkezxLty92rGIyAzg2Zi7iMjZikajtLa2EolEvK5K1oXDYRoaGggGg+f0ec/CXfPIi8jZam1tpbi4mKamJszM6+pkjXOOjo4OWltbmTdv3jltQydURWTaiEQiVFZW5nSwA5gZlZWV5/UNRWPuIjKt5Hqwn3K+7fSu5650FxHJGvXcRUTS1NXVxde//vWz/twtt9xCV1dXFmo0Po25i4ikabxwj8fjE35u/fr1lJWVZataY9LVMiIiabrvvvvYt28fK1asIBgMUlRURF1dHVu2bGHHjh184AMfoKWlhUgkwic/+UnuvfdeAJqammhubqavr4+bb76Z6667jl/96lfU19fzox/9iPz8/IzXVde5i8i09IUfb2fHkZ6MbnPp7BL+9v2XjPv+Aw88wLZt29iyZQsbNmzgve99L9u2bTt9ueKjjz5KRUUFg4ODXHXVVXzwgx+ksrLyLdvYs2cPjz/+ON/61re44447+MEPfsBdd92V0XaAlz13r3YsIpIhq1atest16F/72tf44Q9/CEBLSwt79uw5I9znzZvHihUrALjyyis5cOBAVurmac/dOTdjLmsSkcyaqId9oRQWFp5+vWHDBn7xi1/w61//moKCAq6//voxr1MPhUKnX/v9fgYHB7NSN09PqCbUfReRaaS4uJje3t4x3+vu7qa8vJyCggJ27drFpk2bLnDt3srTnns84fD71HMXkemhsrKSa6+9lksvvZT8/Hxqa2tPv7dmzRq+8Y1vsHz5chYtWsTq1as9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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's an animation of <a href="/train.html#ShowGraph"><code>ShowGraph</code></a> in action.</p>
<p><img src="imgs/train_graph.gif" alt="Training graph"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Internal-callback-implementation">Internal callback implementation<a class="anchor-link" href="#Internal-callback-implementation">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=on_epoch_end></a><code>on_epoch_end</code></h4>
<p><code>on_epoch_end</code>(<code>n_epochs</code>:<code>int</code>, <code>last_metrics</code>:<code>Collection</code>[<code>Union</code>[<code>Tensor</code>, <code>Number</code>]], <code>kwargs</code>) -&gt; <code>bool</code></p>
<p>If we have metrics plot them in our pbar graph <a href="https://github.com/fastai/fastai_pytorch/blob/master/fastai/train.py#L46">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2><a id=GradientClipping></a>class <code>GradientClipping</code></h2>
<p><code>GradientClipping</code>(<code>learn</code>:<a href="/basic_train.html#Learner"><code>Learner</code></a>, <code>clip</code>:<code>float</code>) :: <a href="/basic_train.html#LearnerCallback"><code>LearnerCallback</code></a></p>
<p>To do gradient clipping during training. <a href="https://github.com/fastai/fastai_pytorch/blob/master/fastai/train.py#L64">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Clips gradient at a maximum absolute value of <code>clip</code> during training. For instance:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">ConvLearner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">tvm</span><span class="o">.</span><span class="n">resnet18</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span>
    <span class="n">callback_fns</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">GradientClipping</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="mf">0.1</span><span class="p">))</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




 
 
<div id="db23bd86-eae7-4496-a957-d0047855ddf8"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#db23bd86-eae7-4496-a957-d0047855ddf8');
</script>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Total time: 00:05
epoch  train loss  valid loss  accuracy
0      0.080691    0.043826    0.986261  (00:05)

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Internal-callback-implementation">Internal callback implementation<a class="anchor-link" href="#Internal-callback-implementation">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=on_backward_end></a><code>on_backward_end</code></h4>
<p><code>on_backward_end</code>(<code>kwargs</code>)</p>
<p>Called after backprop but before optimizer step. Useful for true weight decay in AdamW <a href="https://github.com/fastai/fastai_pytorch/blob/master/fastai/train.py#L68">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2><a id=BnFreeze></a>class <code>BnFreeze</code></h2>
<p><code>BnFreeze</code>(<code>learn</code>:<a href="/basic_train.html#Learner"><code>Learner</code></a>) :: <a href="/basic_train.html#LearnerCallback"><code>LearnerCallback</code></a></p>
<p>Freezes moving average statistics in all batchnorm layers <a href="https://github.com/fastai/fastai_pytorch/blob/master/fastai/train.py#L57">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For batchnorm layers where <code>requires_grad==False</code>, you generally don't want to update their moving average statistics, in order to avoid the model's statistics getting out of sync with its pre-trained weights. You can add this callback to automate this freezing of statistics (internally, it calls <code>eval</code> on these layers).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">ConvLearner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">tvm</span><span class="o">.</span><span class="n">resnet18</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">callback_fns</span><span class="o">=</span><span class="n">BnFreeze</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




 
 
<div id="13dab782-0807-4057-9b13-423a4276c190"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#13dab782-0807-4057-9b13-423a4276c190');
</script>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Total time: 00:05
epoch  train loss  valid loss  accuracy
0      0.085482    0.052628    0.984789  (00:05)

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Internal-callback-implementation">Internal callback implementation<a class="anchor-link" href="#Internal-callback-implementation">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=on_epoch_begin></a><code>on_epoch_begin</code></h4>
<p><code>on_epoch_begin</code>(<code>kwargs</code>:<code>Any</code>)</p>
<p>Put bn layers in eval mode on epoch_begin <a href="https://github.com/fastai/fastai_pytorch/blob/master/fastai/train.py#L59">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
</div>
 

