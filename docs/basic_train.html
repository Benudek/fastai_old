---
title: basic_train
keywords: 
sidebar: home_sidebar
tags: 
summary: "Provides basic training and validation with `Learner`"
---

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="basic_train">basic_train<a class="anchor-link" href="#basic_train">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>basic_train</code> wraps together the data (in a <a href="http://docs.fast.ai/data.html#DataBunch"><code>DataBunch</code></a> object) with a pytorch model to define a <a href="http://docs.fast.ai/basic_train.html#Learner"><code>Learner</code></a> object. This is where the basic training loop is defined in the <a href="http://docs.fast.ai/basic_train.html#fit"><code>fit</code></a> function. The <a href="http://docs.fast.ai/basic_train.html#Learner"><code>Learner</code></a> object is the entry point of most of the <a href="http://docs.fast.ai/callback.html#Callback"><code>Callback</code></a> functions that will customize this training loop in different ways, notably:</p>
<ul>
<li><code>Learner.lr_find</code> will launch an LR range test that will help you select a good learning rate</li>
<li><code>Learner.fit_one_cycle</code> will launch a training using the 1cycle policy, to help you train your model fast.</li>
<li><code>Learner.to_fp16</code> will convert your model in half precision and halp you launch a training in mixed precision.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Global-Variable-Definitions:">Global Variable Definitions:<a class="anchor-link" href="#Global-Variable-Definitions:">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>default_lr = slice(3e-3)</code> <div style="text-align: right"><a href="../fastai/basic_train.py#L11">[source]</a></div></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>default_wd = 1e-2</code> <div style="text-align: right"><a href="../fastai/basic_train.py#L12">[source]</a></div></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=fit></a><strong>fit</strong>(<em>epochs</em>=int, <em>model</em>=torch.nn.modules.module.Module, <em>loss_fn</em>: torch.Tensor],=Callable[[torch.Tensor,, <em>opt</em>=torch.optim.optimizer.Optimizer, <em>data</em>=fastai.data.DataBunch, <em>callbacks</em>: NoneType]=Union[Collection[fastai.callback.Callback],, <em>metrics</em>: numbers.Number]],=Union[Collection[Union[torch.Tensor,)</h4>
<p>Fit the <code>model</code> on <code>data</code> and learn using <code>loss</code> and <code>opt</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="http://docs.fast.ai/basic_train.html#fit"><code>fit</code></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3><a id=Learner></a><em>class</em> <strong>Learner</strong>(<em>model</em>=torch.nn.modules.module.Module, <em>opt_fn</em>: functools.partial(&lt;class=Callable, <em>loss_fn</em>: &lt;function=Callable, <em>metrics</em>: None=Collection[Callable], <em>true_wd</em>: True=bool, <em>bn_wd</em>: True=bool, <em>wd</em>: Collection[float]]=Union[float,, <em>train_bn</em>: True=bool, <em>path</em>: None=str, <em>model_dir</em>: 'models'=str, <em>callback_fns</em>: None=Collection[Callable], <em>callbacks</em>: <factory>=Collection[fastai.callback.Callback], <em>layer_groups</em>: None=Collection[torch.nn.modules.module.Module])</h3>
<p>Object that wraps together some data, a model, a loss function and an optimizer</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="http://docs.fast.ai/basic_train.html#Learner"><code>Learner</code></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=create_opt></a><strong>create_opt</strong>(<em>self</em>, <em>lr</em>: Collection[float]]=Union[float,, <em>wd</em>: Collection[float]]=Union[float,)</h4>
<p>create optimizer with <code>lr</code> learning rate and <code>wd</code> weight decay</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.create_opt</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=fit></a><strong>fit</strong>(<em>self</em>, <em>epochs</em>=int, <em>lr</em>: Collection[float],=Union[float,, <em>wd</em>: Collection[float]]=Union[float,, <em>callbacks</em>: None=Collection[fastai.callback.Callback])</h4>
<p>fit the model on this learner with <code>lr</code> learning rate, <code>wd</code> weight decay for <code>epochs</code> with <code>callbacks</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.fit</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=fit_one_cycle></a><strong>fit_one_cycle</strong>(<em>learn</em>, <em>cyc_len</em>=fastai.basic_train.Learner, <em>max_lr</em>: Collection[float],=int, <em>moms</em>: float]=Union[float,, <em>div_factor</em>: 25.0=Tuple[float,, <em>pct_start</em>: 0.3=float, <em>wd</em>: None=float, <em>**kwargs</em>=float)</h4>
<p>Fits a model following the 1cycle policy</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.fit_one_cycle</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=freeze></a><strong>freeze</strong>(<em>self</em>)</h4>
<p>freeze up to last layer</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.freeze</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=freeze_to></a><strong>freeze_to</strong>(<em>self</em>, <em>n</em>=int)</h4>
<p>freeze layers up to layer <code>n</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.freeze_to</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=_learn_get_preds></a><strong>_learn_get_preds</strong>(<em>learn</em>=fastai.basic_train.Learner, <em>is_test</em>: False=bool)</h4>
<p>Wrapper of get_preds for learner</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.get_preds</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=init></a><strong>init</strong>(<em>self</em>, <em>init</em>)</h4>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.init</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=load></a><strong>load</strong>(<em>self</em>, <em>name</em>: str]=Union[pathlib.Path,)</h4>
<p>load model <code>name</code> from `self.model_dir</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.load</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=cross_entropy></a><strong>cross_entropy</strong>(<em>input</em>, <em>target</em>, <em>weight</em>=None, <em>size_average</em>=None, <em>ignore_index</em>=-100, <em>reduce</em>=None, <em>reduction</em>='elementwise_mean')</h4>
<p>function.</p>
<p>See :class:<code>~torch.nn.CrossEntropyLoss</code> for details.</p>
<p>Args:
    input (Tensor) : :math:<code>(N, C)</code> where <code>C = number of classes</code> or :math:<code>(N, C, H, W)</code>
        in case of 2D Loss, or :math:<code>(N, C, d_1, d_2, ..., d_K)</code> where :math:<code>K &gt; 1</code>
        in the case of K-dimensional loss.
    target (Tensor) : :math:<code>(N)</code> where each value is :math:<code>0 \leq \text{targets}[i] \leq C-1</code>,
        or :math:<code>(N, d_1, d_2, ..., d_K)</code> where :math:<code>K \geq 1</code> for
        K-dimensional loss.
    weight (Tensor, optional): a manual rescaling weight given to each
        class. If given, has to be a Tensor of size <code>C</code>
    size_average (bool, optional): Deprecated (see :attr:<code>reduction</code>). By default,
        the losses are averaged over each loss element in the batch. Note that for
        some losses, there multiple elements per sample. If the field :attr:<code>size_average</code>
        is set to <code>False</code>, the losses are instead summed for each minibatch. Ignored
        when reduce is <code>False</code>. Default: <code>True</code>
    ignore_index (int, optional): Specifies a target value that is ignored
        and does not contribute to the input gradient. When :attr:<code>size_average</code> is
        <code>True</code>, the loss is averaged over non-ignored targets. Default: -100
    reduce (bool, optional): Deprecated (see :attr:<code>reduction</code>). By default, the
        losses are averaged or summed over observations for each minibatch depending
        on :attr:<code>size_average</code>. When :attr:<code>reduce</code> is <code>False</code>, returns a loss per
        batch element instead and ignores :attr:<code>size_average</code>. Default: <code>True</code>
    reduction (string, optional): Specifies the reduction to apply to the output:
        'none' | 'elementwise_mean' | 'sum'. 'none': no reduction will be applied,
        'elementwise_mean': the sum of the output will be divided by the number of
        elements in the output, 'sum': the output will be summed. Note: :attr:<code>size_average</code>
        and :attr:<code>reduce</code> are in the process of being deprecated, and in the meantime,
        specifying either of those two args will override :attr:<code>reduction</code>. Default: 'elementwise_mean'</p>
<p>Examples::</p>

<pre><code>&gt;&gt;&gt; input = torch.randn(3, 5, requires_grad=True)
&gt;&gt;&gt; target = torch.randint(5, (3,), dtype=torch.int64)
&gt;&gt;&gt; loss = F.cross_entropy(input, target)
&gt;&gt;&gt; loss.backward()</code></pre>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.loss_fn</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=lr_find></a><strong>lr_find</strong>(<em>learn</em>=fastai.basic_train.Learner, <em>start_lr</em>: 1e-05=float, <em>end_lr</em>: 10=float, <em>num_it</em>: 100=int, <em>**kwargs</em>=Any)</h4>
<p>Explore lr from <code>start_lr</code> to <code>end_lr</code> over <code>num_it</code> iterations of <code>learn</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.lr_find</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=lr_range></a><strong>lr_range</strong>(<em>self</em>, <em>lr</em>: slice]=Union[float,)</h4>
<p>Build learning rate schedule</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.lr_range</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=mixup></a><strong>mixup</strong>(<em>learn</em>=fastai.basic_train.Learner, <em>alpha</em>: 0.4=float, <em>stack_x</em>: False=bool, <em>stack_y</em>: True=bool)</h4>
<p>Adds mixup <a href="https://arxiv.org/abs/1710.09412">https://arxiv.org/abs/1710.09412</a> to the learner</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.mixup</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=pred_batch></a><strong>pred_batch</strong>(<em>learn</em>=fastai.basic_train.Learner, <em>is_valid</em>: True=bool)</h4>
<p>Returns input, target and output of the model on a batch</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.pred_batch</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=save></a><strong>save</strong>(<em>self</em>, <em>name</em>: str]=Union[pathlib.Path,)</h4>
<p>save model with <code>name</code> to <code>self.model_dir</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.save</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=split></a><strong>split</strong>(<em>self</em>, <em>split_on</em>: Collection[Collection[torch.nn.modules.module.Module]]]=Union[Callable,)</h4>
<p>split the model at <code>split_on</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.split</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=to_fp16></a><strong>to_fp16</strong>(<em>learn</em>=fastai.basic_train.Learner, <em>loss_scale</em>: 512.0=float, <em>flat_master</em>: False=bool)</h4>
<p>Transforms the learner in FP16 precision</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.to_fp16</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=_TTA></a><strong>_TTA</strong>(<em>learn</em>=fastai.basic_train.Learner, <em>beta</em>: 0.4=float, <em>scale</em>: 1.35=float, <em>is_test</em>: False=bool)</h4>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.TTA</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=_tta_only></a><strong>_tta_only</strong>(<em>learn</em>=fastai.basic_train.Learner, <em>is_test</em>: False=bool, <em>scale</em>: 1.25=float)</h4>
<p>Computes the outputs for several augmented inputs for TTA</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.tta_only</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=unfreeze></a><strong>unfreeze</strong>(<em>self</em>)</h4>
<p>unfreeze entire model</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Learner.unfreeze</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3><a id=LearnerCallback></a><em>class</em> <strong>LearnerCallback</strong>() :: Inherits from (<code>Callback</code>)</h3>
<p>Base class for creating callbacks for the <code>Learner</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="http://docs.fast.ai/basic_train.html#LearnerCallback"><code>LearnerCallback</code></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=loss_batch></a><strong>loss_batch</strong>(<em>model</em>=torch.nn.modules.module.Module, <em>xb</em>=torch.Tensor, <em>yb</em>=torch.Tensor, <em>loss_fn</em>: torch.Tensor],=Union[Callable[[torch.Tensor,, <em>opt</em>: NoneType]=Union[torch.optim.optimizer.Optimizer,, <em>cb_handler</em>: NoneType]=Union[fastai.callback.CallbackHandler,, <em>metrics</em>: numbers.Number]],=Union[Collection[Union[torch.Tensor,)</h4>
<p>Calculate loss for a batch, calculate metrics, call out to callbacks as necessary</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="http://docs.fast.ai/basic_train.html#loss_batch"><code>loss_batch</code></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3><a id=Recorder></a><em>class</em> <strong>Recorder</strong>() :: Inherits from (<code>LearnerCallback</code>)</h3>
<p>A <code>LearnerCallback</code> that records epoch,loss,opt and metric data during training</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="http://docs.fast.ai/basic_train.html#Recorder"><code>Recorder</code></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=format_stats></a><strong>format_stats</strong>(<em>self</em>, <em>stats</em>: numbers.Number]]=Collection[Union[torch.Tensor,)</h4>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Recorder.format_stats</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=on_backward_begin></a><strong>on_backward_begin</strong>(<em>self</em>, <em>smooth_loss</em>=torch.Tensor, <em>**kwargs</em>=Any)</h4>
<p>Record the loss before any other callback has a chance to modify it.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Recorder.on_backward_begin</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=on_batch_begin></a><strong>on_batch_begin</strong>(<em>self</em>, <em>**kwargs</em>=Any)</h4>
<p>Record learning rate and momentum at beginning of batch</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Recorder.on_batch_begin</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=on_epoch_end></a><strong>on_epoch_end</strong>(<em>self</em>, <em>epoch</em>=int, <em>num_batch</em>=int, <em>smooth_loss</em>=torch.Tensor, <em>last_metrics</em>: numbers.Number]]=typing.Collection[typing.Union[torch.Tensor,, <em>**kwargs</em>=Any)</h4>
<p>Save epoch info: num_batch, smooth_loss, metrics</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Recorder.on_epoch_end</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=on_train_begin></a><strong>on_train_begin</strong>(<em>self</em>, <em>pbar</em>: fastprogress.fastprogress.ProgressBar]=Union[fastprogress.fastprogress.MasterBar,, <em>metrics</em>: torch.Tensor],=Collection[Callable[[torch.Tensor,, <em>**kwargs</em>=Any)</h4>
<p>Initialize recording status at beginning of training</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Recorder.on_train_begin</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=plot></a><strong>plot</strong>(<em>self</em>, <em>skip_start</em>: 10=int, <em>skip_end</em>: 5=int)</h4>
<p>Plot learning rate and losses, trimmed between <code>skip_start</code> and <code>skip_end</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Recorder.plot</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=plot_losses></a><strong>plot_losses</strong>(<em>self</em>)</h4>
<p>Plot training and validation losses</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Recorder.plot_losses</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=plot_lr></a><strong>plot_lr</strong>(<em>self</em>, <em>show_moms</em>=False)</h4>
<p>Plot learning rate, <code>show_moms</code> to include momentum</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Recorder.plot_lr</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=plot_metrics></a><strong>plot_metrics</strong>(<em>self</em>)</h4>
<p>Plot metrics collected during training</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Recorder.plot_metrics</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=train_epoch></a><strong>train_epoch</strong>(<em>model</em>=torch.nn.modules.module.Module, <em>dl</em>=torch.utils.data.dataloader.DataLoader, <em>opt</em>=torch.optim.optimizer.Optimizer, <em>loss_func</em>: torch.Tensor],=Callable[[torch.Tensor,)</h4>
<p>Simple training of <code>model</code> for 1 epoch of <code>dl</code> using optim <code>opt</code> and loss function <code>loss_func</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="http://docs.fast.ai/basic_train.html#train_epoch"><code>train_epoch</code></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=validate></a><strong>validate</strong>(<em>model</em>=torch.nn.modules.module.Module, <em>dl</em>=torch.utils.data.dataloader.DataLoader, <em>loss_fn</em>: torch.Tensor],=Union[Callable[[torch.Tensor,, <em>metrics</em>: numbers.Number]],=Union[Collection[Union[torch.Tensor,, <em>cb_handler</em>: NoneType]=Union[fastai.callback.CallbackHandler,, <em>pbar</em>: fastprogress.fastprogress.ProgressBar,=Union[fastprogress.fastprogress.MasterBar,)</h4>
<p>Calculate loss and metrics for the validation set</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="http://docs.fast.ai/basic_train.html#validate"><code>validate</code></a></p>

</div>
</div>
</div>
</div>
 

